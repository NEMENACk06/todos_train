<!-- app/views/categories/index.html.erb -->
<div class="max-w-4xl mx-auto p-6 bg-gradient-to-b from-indigo-50 to-pink-50 min-h-screen">
  <h1 class="text-3xl font-extrabold mb-8 text-center text-indigo-700">📋 Categories & Todos</h1>
  <!-- Add Category Form -->
  <div class="mb-10">
    <%= form_with model: @category, class: "flex space-x-2" do |f| %>
      <%= f.text_field :name,
        placeholder: "New category",
        class: "flex-1 border-2 border-indigo-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-400" %>
      <%= f.submit "➕ Add Category",
        class: "px-5 py-2 bg-pink-500 text-white font-semibold rounded hover:bg-pink-600 transition" %>
    <% end %>
  </div>
  <!-- Categories Loop -->
  <div class="space-y-8">
    <% @categories.each do |category| %>
      <div class="border-2 border-indigo-200 rounded-xl bg-white shadow-lg p-5">
        <h2 class="text-xl font-bold text-indigo-600 mb-4 flex justify-between items-center">
          💡 <%= category.name %>
          <%= link_to "🗑 Delete",
      category_path(category),
      data: { turbo_method: :delete, turbo_confirm: "Delete this category and its todos?" },
      class: "text-red-500 hover:text-red-700" %>
        </h2>
        <!-- Todos list -->
        <ul class="space-y-2">
          <% category.todos.each do |todo| %>
            <li class="flex items-center justify-between p-3 border rounded-lg bg-gradient-to-r from-emerald-50 to-amber-50 hover:shadow-md transition">
              <div>
                <span class="<%= todo.is_done ? 'line-through text-gray-400' : 'text-gray-800 font-medium' %>">
                  <%= todo.title %>
                </span>
                <span class="ml-2 text-sm px-2 py-0.5 rounded-full <%= priority_badge_class(todo) %>">
                  <%= priority_label(todo) %>
                </span>
              </div>
              <!-- Delete -->
              <%= link_to "❌",
                  category_todo_path(category, todo),
                  data: { turbo_method: :delete, turbo_confirm: "Delete this todo?" },
                  class: "text-red-500 hover:text-red-700 text-lg" %>
            </li>
          <% end %>
        </ul>
        <!-- Add Todo Form -->
        <div class="mt-5">
          <%= form_with model: [category, category.todos.build], class: "flex space-x-2" do |f| %>
            <%= f.text_field :title,
              placeholder: "New todo",
              class: "flex-1 border-2 border-emerald-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-400" %>
            <%= f.select :priority_level,
  priority_options_for_select,
  {},
  class: "border-2 border-amber-300 rounded px-2 py-2 focus:outline-none focus:ring-2 focus:ring-amber-400" %>
            <%= f.submit "Add Todo",
              class: "px-5 py-2 bg-emerald-500 text-white font-semibold rounded hover:bg-emerald-600 transition" %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
